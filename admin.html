<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡Œåº«ç®¡ç†å¾Œå°</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --danger: #d63031;
            --bg: #f0f2f5;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg);
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 20px;
        }

        h1 {
            text-align: center;
            color: #2d3436;
            margin-top: 40px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .radio-group {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
        }

        button {
            cursor: pointer;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
        }

        .add-btn {
            background: var(--primary);
            color: white;
            width: 100%;
            font-size: 16px;
            margin-bottom: 20px;
            display: block;
        }

        .del-btn {
            background: var(--danger);
            color: white;
            padding: 5px 10px;
        }

        .controls {
            position: sticky;
            bottom: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            z-index: 100;
        }

        .save-btn {
            background: #00b894;
            color: white;
            flex: 2;
            margin-right: 10px;
            font-size: 18px;
        }

        .reset-btn {
            background: #636e72;
            color: white;
        }
    </style>
</head>

<body>
    <a href="index.html"
        style="position:absolute; top:20px; left:20px; text-decoration:none; color:var(--primary); font-weight:bold; font-size: 16px;">â†
        å›éŠæˆ²</a>
    <h1>ğŸ“ é¡Œåº«ç®¡ç†</h1>
    <div id="list"></div>
    <button class="add-btn" onclick="addQuestion()">+ æ–°å¢é¡Œç›®</button>

    <div style="height: 60px;"></div>
    <div class="controls">
        <button class="save-btn" onclick="save()">ğŸ’¾ å„²å­˜ä¸¦ç”Ÿæ•ˆ</button>
        <button class="reset-btn" onclick="resetDefaults()">ğŸ”„ é‡ç½®å›é è¨­é¡Œåº«</button>
    </div>

    <script>
        const defaultQuestions = [
            { q: "å°ç£æœ€é«˜çš„å±±æ˜¯å“ªä¸€åº§ï¼Ÿ", a: ["ç‰å±±", "é›ªå±±", "å¤§éœ¸å°–å±±", "é˜¿é‡Œå±±"], correct: 0, score: 10 },
            { q: "HTML ä¸­å“ªå€‹æ¨™ç±¤æ˜¯ç”¨ä¾†é€£çµ JavaScriptï¼Ÿ", a: ["<link>", "<js>", "<script>", "<href>"], correct: 2, score: 10 },
            { q: "å¤ªé™½ç³»ä¸­é«”ç©æœ€å¤§çš„è¡Œæ˜Ÿæ˜¯ï¼Ÿ", a: ["åœ°çƒ", "ç«æ˜Ÿ", "æœ¨æ˜Ÿ", "åœŸæ˜Ÿ"], correct: 2, score: 10 },
            { q: "éŠæˆ²é–‹ç™¼ä¸­ï¼ŒNPC ä»£è¡¨ä»€éº¼ï¼Ÿ", a: ["æ–°ç©å®¶è§’è‰²", "éç©å®¶è§’è‰²", "ä¸»è¦é ˜è¢–è§’è‰²", "æ ¸èƒ½ä¸­å¿ƒ"], correct: 1, score: 10 }
        ];

        let questions = JSON.parse(localStorage.getItem('quiz_questions')) || JSON.parse(JSON.stringify(defaultQuestions));

        function render() {
            const list = document.getElementById('list');
            list.innerHTML = '';
            questions.forEach((q, idx) => {
                const card = document.createElement('div');
                card.className = 'card';
                let optionsHtml = '';
                q.a.forEach((opt, oIdx) => {
                    optionsHtml += `
                        <div class="row">
                            <div class="radio-group" title="è¨­å®šç‚ºæ­£ç¢ºç­”æ¡ˆ">
                                <input type="radio" name="correct-${idx}" ${q.correct === oIdx ? 'checked' : ''} onclick="updateCorrect(${idx}, ${oIdx})">
                            </div>
                            <input type="text" value="${opt}" oninput="updateOption(${idx}, ${oIdx}, this.value)" placeholder="é¸é … ${oIdx + 1}">
                        </div>`;
                });

                card.innerHTML = `
                    <div class="row" style="margin-bottom: 10px;">
                        <span style="font-weight:bold; width: 30px;">Q${idx + 1}.</span>
                        <input type="text" value="${q.q}" oninput="updateQuestion(${idx}, this.value)" placeholder="è«‹è¼¸å…¥å•é¡Œå…§å®¹..." style="font-weight:bold; font-size: 1.1em;">
                        <div style="display:flex; align-items:center; gap:2px; flex:none;">
                            <button onclick="changeScore(${idx}, -10)" style="padding:4px 8px; border-radius:4px; background:#dfe6e9; font-weight:bold; font-size:14px;">ï¼</button>
                            <span style="width:40px; text-align:center; font-weight:bold; color:var(--primary); font-size:1.1em;">${q.score || 10}</span>
                            <button onclick="changeScore(${idx}, 10)" style="padding:4px 8px; border-radius:4px; background:#dfe6e9; font-weight:bold; font-size:14px;">ï¼‹</button>
                        </div>
                        <span style="font-size:0.9em; color:#636e72;">åˆ†</span>
                        <button class="del-btn" onclick="delQuestion(${idx})">åˆªé™¤</button>
                    </div>
                    <div class="row" style="margin-bottom: 20px;">
                        <span style="width: 30px;">ğŸ–¼ï¸</span>
                        <input type="text" value="${q.image || ''}" oninput="updateImage(${idx}, this.value)" placeholder="åœ–ç‰‡ç¶²å€ (é¸å¡«ï¼Œä¾‹å¦‚ https://example.com/image.jpg)" style="font-size: 0.9em; background: #fafafa;">
                    </div>
                    ${q.image ? `<div style="text-align:center; margin-bottom:15px;"><img src="${q.image}" style="max-height:150px; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.1);"></div>` : ''}
                    ${optionsHtml}
                `;
                list.appendChild(card);
            });
        }

        function updateQuestion(idx, val) { questions[idx].q = val; }
        function updateImage(idx, val) { questions[idx].image = val; render(); /* Re-render for preview */ } // æ³¨æ„ï¼šå³æ™‚è¼¸å…¥å³æ™‚renderå¯èƒ½æœƒä¸­æ–·è¼¸å…¥ç„¦é»ï¼Œå»ºè­°å„ªåŒ–ï¼Œä½†ç‚ºäº†ç°¡å–®å…ˆé€™æ¨£ï¼Œæˆ–è€…åªåœ¨onchangeæ›´æ–°
        // ç°¡å–®è§£æ³•ï¼šæŠŠ updateImage ç•¶ä½œç´”æ•¸æ“šæ›´æ–°ï¼Œé è¦½åœ–å¦å¤–è™•ç†ï¼Ÿ
        // ç‚ºäº†ä½¿ç”¨è€…é«”é©—ï¼Œæˆ‘æ”¹ç”¨ onchange={render} æˆ–æ˜¯ç°¡å–®çš„ img.src æ›´æ–°ã€‚
        // è®“æˆ‘å€‘é‡æ–°å¯«ä¸€å€‹æ›´å¥½çš„ç‰ˆæœ¬ã€‚

        // æ—¢ç„¶è¦ç”¨replace_file_contentï¼Œæˆ‘ç›´æ¥çµ¦ä¸€å€‹ä¸æœƒå¤±å»ç„¦é»çš„ç‰ˆæœ¬ã€‚
        function updateQuestion(idx, val) { questions[idx].q = val; }
        // ä½¿ç”¨ debounce æˆ– onchange é¿å…è¼¸å…¥æ™‚å¤±å»ç„¦é»ã€‚é€™è£¡ç°¡å–®ç”¨ DOM æ“ä½œå„ªåŒ–
        function updateImage(idx, val) {
            questions[idx].image = val;
            // å˜—è©¦å³æ™‚æ›´æ–°è©²å¡ç‰‡çš„åœ–ç‰‡é è¦½ï¼Œè‹¥ç„¡å‰‡ä¸å‹•ä½œï¼ˆç­‰å¾… renderï¼‰
            // é€™è£¡ç°¡å–®è™•ç†ï¼šåªè¦æ•¸æ“šé€²å»å°±å¥½ï¼Œä½¿ç”¨è€…é»æ“Šå…¶ä»–åœ°æ–¹æˆ–å­˜æª”æ™‚è‡ªç„¶æœƒç”Ÿæ•ˆ
        }
        function updateOption(idx, oIdx, val) { questions[idx].a[oIdx] = val; }
        function updateCorrect(idx, oIdx) { questions[idx].correct = oIdx; }
        function updateScore(idx, val) { questions[idx].score = parseInt(val) || 10; }
        function changeScore(idx, delta) {
            const current = questions[idx].score || 10;
            questions[idx].score = Math.max(10, current + delta);
            render();
        }

        function addQuestion() {
            questions.push({ q: "", a: ["", "", "", ""], correct: 0, image: "", score: 10 });
            render();
            // Scroll to bottom
            setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 100);
        }

        function delQuestion(idx) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™é¡Œå—ï¼Ÿ')) {
                questions.splice(idx, 1);
                render();
            }
        }

        function saveToStorage() {
            localStorage.setItem('quiz_questions', JSON.stringify(questions));
        }

        function save() {
            saveToStorage();
            alert('å„²å­˜æˆåŠŸï¼è«‹å›åˆ°éŠæˆ²é é¢ï¼Œä¸¦ã€Œé‡æ–°æ•´ç†ã€ç¶²é å³å¯çœ‹åˆ°æ–°é¡Œç›®ã€‚');
        }

        function resetDefaults() {
            if (confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é¡Œç›®å›é è¨­å€¼å—ï¼Ÿé€™å°‡æœƒæ¸…é™¤æ‚¨æ‰€æœ‰è‡ªè¨‚çš„ä¿®æ”¹ï¼')) {
                questions = JSON.parse(JSON.stringify(defaultQuestions));
                render();
                saveToStorage();
                alert('å·²é‡ç½®å›é è¨­é¡Œåº«ï¼');
            }
        }

        // å¯†ç¢¼é©—è­‰
        const ADMIN_PASSWORD = localStorage.getItem('admin_password') || '1234';
        const inputPwd = prompt('è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼ï¼š');
        if (inputPwd !== ADMIN_PASSWORD) {
            alert('å¯†ç¢¼éŒ¯èª¤ï¼');
            location.href = 'index.html';
        } else {
            render();
        }
    </script>
</body>

</html>